[
  {
    "version": 1,
    "description": "Create diary_versions table",
    "sql": "CREATE TABLE IF NOT EXISTS diary_versions (id TEXT PRIMARY KEY, diary_id TEXT NOT NULL, title TEXT NOT NULL, date TEXT NOT NULL, content TEXT NOT NULL, location_latitude REAL, location_longitude REAL, location_description TEXT, location_city TEXT, weather_wmo_code INTEGER, weather_description TEXT, weather_temperature_min REAL, weather_temperature_max REAL, archived_at TEXT, created_at TEXT NOT NULL)"
  },
  {
    "version": 2,
    "description": "Create diary_heads table",
    "sql": "CREATE TABLE IF NOT EXISTS diary_heads (diary_id TEXT PRIMARY KEY, version_id TEXT NOT NULL)"
  },
  {
    "version": 3,
    "description": "Create diary_drafts table",
    "sql": "CREATE TABLE IF NOT EXISTS diary_drafts (diary_id TEXT PRIMARY KEY, title TEXT NOT NULL, date TEXT NOT NULL, content TEXT NOT NULL, location_latitude REAL, location_longitude REAL, location_description TEXT, location_city TEXT, weather_wmo_code INTEGER, weather_description TEXT, weather_temperature_min REAL, weather_temperature_max REAL, created_at TEXT NOT NULL, updated_at TEXT NOT NULL, sealed_at TEXT, pending_version_id TEXT)"
  },
  {
    "version": 4,
    "description": "Create streams table",
    "sql": "CREATE TABLE IF NOT EXISTS streams (stream_id TEXT PRIMARY KEY, name TEXT, imported_file_size INTEGER, imported_file_mtime INTEGER, imported_at TEXT)"
  },
  {
    "version": 5,
    "description": "Create diaries view",
    "sql": "CREATE VIEW IF NOT EXISTS diaries AS SELECT dv.id, dv.diary_id, dv.title, dv.date, dv.content, dv.location_latitude, dv.location_longitude, dv.location_description, dv.location_city, dv.weather_wmo_code, dv.weather_description, dv.weather_temperature_min, dv.weather_temperature_max, dv.archived_at, dv.created_at FROM diary_versions dv JOIN diary_heads dh ON dv.id = dh.version_id WHERE dv.archived_at IS NULL"
  },
  {
    "version": 6,
    "description": "Create debug_logs table",
    "sql": "CREATE TABLE IF NOT EXISTS debug_logs (id INTEGER PRIMARY KEY AUTOINCREMENT, timestamp TEXT NOT NULL, level TEXT NOT NULL, message TEXT NOT NULL, details TEXT)"
  },
  {
    "version": 7,
    "description": "Create settings table",
    "sql": "CREATE TABLE IF NOT EXISTS settings (key TEXT PRIMARY KEY, value TEXT NOT NULL)"
  }
]
